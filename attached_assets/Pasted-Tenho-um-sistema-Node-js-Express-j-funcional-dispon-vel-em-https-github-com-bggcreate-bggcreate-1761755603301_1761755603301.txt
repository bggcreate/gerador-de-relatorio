Tenho um sistema Node.js/Express já funcional, disponível em: https://github.com/bggcreate/bggcreate

O sistema já possui controle de acesso por cargos (Gerente, Consultor, Monitoramento, Admin, Dev).  
Agora quero **acrescentar um novo cargo: “Técnico”**, responsável por toda a parte de assistência técnica.

------------------------------------------
OBJETIVO:
------------------------------------------
Implementar um módulo completo de **Assistência Técnica** e **Estoque Técnico**, visível e acessível apenas para usuários com cargo “técnico” (e também acessível para Admin e Dev).

------------------------------------------
NOVO CARGO: TÉCNICO
------------------------------------------

1. **Função principal:**
   - Gerenciar o fluxo de assistência técnica de produtos.
   - Controlar status das assistências, estoque de peças e histórico de chamados.

2. **Acessos do Técnico:**
   - Nova aba no menu chamada **“Assistência Técnica”**.
   - Acesso restrito às funções relacionadas à assistência e estoque.
   - Não precisa acessar dashboards de lojas ou relatórios administrativos.

3. **Subseções e funcionalidades:**
   
   **a) Estoque de Produtos**
   - Página simples listando as peças disponíveis.
   - Cada produto deve conter:
     - Nome da peça
     - Código/ID interno
     - Quantidade em estoque
     - Valor da peça (custo da loja)
     - Botão de “Atualizar Estoque”
   - Permitir busca por nome e filtro por disponibilidade.
   
   **b) Chamados de Assistência**
   - Tabela com os chamados abertos, mostrando:
     - Cliente
     - Loja (se aplicável)
     - Status atual (Em andamento, Concluído, Falta de peças)
     - Data de abertura
     - Botão “Ver Detalhes” ou “Editar”

   **c) Cadastro de Assistência**
   - Formulário completo com os seguintes campos:
     - Nome do cliente
     - CPF
     - Número do pedido
     - Data de entrada
     - Valor da peça paga pela loja
     - Valor que o cliente vai pagar pela assistência
     - Aparelho (ex: modelo, marca)
     - Peça a ser trocada (selecionável a partir do estoque)
     - Campo de observações gerais
     - Campo “Status” (dropdown: Em andamento / Concluído / Falta de peças)
   - Botão **“Concluir Assistência”**, que:
     - Salva os dados no banco
     - Envia o ticket para o **Histórico de Assistências**
     - Atualiza o status do estoque (reduz quantidade da peça usada)
   
   **d) Histórico de Assistências**
   - Página para listagem de assistências concluídas.
   - Mostrar informações resumidas:
     - Nome do cliente, data, status final, valor pago, aparelho, peça trocada.
   - Permitir pesquisa e filtro por status ou cliente.

------------------------------------------
ESTRUTURA TÉCNICA:
------------------------------------------

- Criar nova aba: `assistencia.html`
- Criar script JS: `assistencia.js`
- Criar rotas no backend:
  - `GET /assistencia` → página principal (somente técnicos, admin, dev)
  - `POST /assistencia/cadastrar` → cadastro de nova assistência
  - `GET /assistencia/listar` → listar assistências ativas
  - `GET /assistencia/historico` → listar assistências concluídas
  - `POST /assistencia/status` → atualizar status
  - `GET /estoque` e `POST /estoque` → controle de estoque técnico
- Criar tabela no banco:
  - `assistencias` com os campos descritos acima.
  - `estoque_tecnico` com as peças e quantidades.

------------------------------------------
INTERFACE E DESIGN:
------------------------------------------
- Layout seguindo o mesmo padrão do sistema atual.
- Ícones genéricos (ex: <i class="icon-example"></i>) para substituição posterior.
- Separar as seções em abas ou cards dentro da página Assistência Técnica.
- Responsivo, organizado e fácil de navegar.

------------------------------------------
PERMISSÕES:
------------------------------------------
- “Técnico” pode acessar apenas a aba **Assistência Técnica** (estoque, chamados, histórico).
- “Admin” e “Dev” podem acessar todas as abas, incluindo Assistência Técnica.
- Outros cargos (Gerente, Consultor, Monitoramento) **não** devem visualizar essa aba.

------------------------------------------
ENTREGÁVEIS:
------------------------------------------
1. Nova rota e view `assistencia.html`
2. Script `assistencia.js` para controle dinâmico (formulários, filtros, status)
3. Criação das tabelas `assistencias` e `estoque_tecnico`
4. Integração de permissões no middleware `roleAuth.js`
5. Ajuste do menu para incluir a aba “Assistência Técnica” (visível apenas para técnico, admin e dev)
6. Página de histórico funcional
7. Atualização de estoque automática ao concluir uma assistência

------------------------------------------
RESUMO:
------------------------------------------
O cargo “Técnico” deve ter uma área exclusiva para gerenciar assistências técnicas, controlar estoque de peças, cadastrar novos chamados e concluir atendimentos.  
O sistema deve registrar e exibir o histórico, atualizar o estoque e manter o controle completo da operação técnica.
